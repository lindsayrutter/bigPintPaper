\documentclass[]{bmcart}
\setlength{\parskip}{10pt}
\usepackage[lined]{algorithm2e} %lined!
\begin{document}

\DontPrintSemicolon
\begin{algorithm}[H]
\SetInd{0.2em}{1.3em}

\KwData{Data frame input by user}
\KwResult{Interactive scatterplot matrix}

/* \textit{Declare Shiny server}\;
\SetKwBlock{Fna}{\textnormal{server $\leftarrow$ function(input, output, session)\{ }}{}
\Fna{
\BlankLine
/* \textit{Declare Shiny output scatterplot matrix}\;
\SetKwBlock{Fnb}{\textnormal{output\$scatMatPlot $\leftarrow$ renderPlotly(\{ }}{}
\Fnb{
\BlankLine
/* Draw hexagons and x=y line in bottom-left corner of matrix\;
my\_fn $\leftarrow$ function(data, mapping)\{\}\;
\BlankLine
/* \textit{Create static scatterplot matrix}\;
p $\leftarrow$ ggpairs(data, lower = list(continuous = my\_fn))\;
\BlankLine
/* \textit{Convert ggplot2::ggplot() object to plotly object}\;
ggP $\leftarrow$ ggplotly(p)\;
\BlankLine
/* \textit{Tailor plotly scatterplot matrix interactivity with JavaScript}\;
\SetKwBlock{Fnc}{\textnormal{ggPR $\leftarrow$ ggP \%$>$\% onRender("function(el, x, data)\{ }}{}\;
\Fnc{
\BlankLine
/* \textit{If the user clicks on the plotly scatterplot matrix object}\;
\SetKwBlock{Fnd}{\textnormal{el.on('plotly\_click', function(e)\{ }}{}\;
\Fnd{
\BlankLine
/* \textit{Delete any old superimposed plotly geoms (orange dots)}\;
if (x.data.length $>$ 0)\{Plotly.deleteTraces(el.id)\}\;
\BlankLine
/* \textit{Determine gene IDs selected by user click. Save as object called selID with handle called 'selID' so it can be read outside current JavaScript function back in Shiny}\;
Shiny.onInputChange('selID', selID)\;
\BlankLine
/* \textit{Create traces for selected gene IDs as orange points that state gene names upon hovering}\;
trace = \{mode: 'markers', color: 'orange', size: 6, text: selID, hoverinfo: 'text'\}\;
\BlankLine
/* \textit{Superimpose traces onto the plotly scatterplot matrix object}\;
Plotly.addTraces(el.id, Traces)\;
}\})\;
}\})\;
\BlankLine
/* \textit{Pass the R data object into the JavaScript function}\;
", data = data\;
}\})\;
\BlankLine
/* \textit{Read into Shiny the gene IDs that user clicked on}\;
selID $\leftarrow$ reactive(input\$selID)\;
\BlankLine
/* \textit{Create data subset (read counts) for only the selected gene IDs}\;
pcpDat $\leftarrow$ reactive(data[which(data\$ID \%$>$\% selID()), ])\;
\BlankLine
/* \textit{Create static box plot of the full dataset}\;
BP $\leftarrow$ ggplot(data) $+$ geom\_boxplot()\;
\BlankLine
/* \textit{Render boxplot interactive as a plotly object}\;
ggBP $\leftarrow$ ggplotly(BP)\;
\BlankLine
/* \textit{Declare Shiny output boxplot}\;
\SetKwBlock{Fne}{\textnormal{output\$boxPlot $\leftarrow$ renderPlotly(\{ }}{}\;
\Fne{
\BlankLine
/* \textit{Tailor interactivity of the plotly boxplot object using custom JavaScript}\;
ggBP \%$>$\% onRender("function(el, x, data)\{\;
\BlankLine
/* \textit{Create traces for selected gene IDs as orange lines that state gene names upon hovering}\;
trace = \{mode: 'lines', color: 'orange', width: 1.5, text: selID, hoverinfo: 'text'\}\;
\BlankLine
/* \textit{Push traces to be superimposed onto the plotly scatterplot matrix object}\;
Plotly.addTraces(el.id, Traces)\;
\BlankLine
/* \textit{Pass R objects into the JavaScript function}\;
\}", data = list(pcpDat = pcpDat())\;
}\})\;
}\}\;

\caption{Pseudocode for interactive scatterplot matrix}
\end{algorithm}
\end{document}